openapi: 3.0.3
info:
  title: Bilibili Synced Playback API
  version: 0.1.0
servers:
  - url: https://example.com/api
paths:
  /login:
    post:
      summary: Authenticate via shared password
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                password:
                  type: string
              required:
                - password
      responses:
        "200":
          description: Authenticated
        "401":
          description: Invalid password
  /video:
    post:
      summary: Submit a Bilibili video URL to load for the shared session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                url:
                  type: string
              required:
                - url
      responses:
        "200":
          description: Video accepted and loaded
        "400":
          description: Invalid or unsupported video URL
        "401":
          description: Not authenticated
  /state:
    get:
      summary: Get current shared playback state
      responses:
        "200":
          description: Current state
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                  status:
                    type: string
                    enum: [playing, paused]
                  position_ms:
                    type: integer
                  updated_at:
                    type: string
                    format: date-time
        "401":
          description: Not authenticated
  /control:
    post:
      summary: Apply a playback control action to the shared session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                type:
                  type: string
                  enum: [play, pause, seek]
                position_ms:
                  type: integer
              required:
                - type
      responses:
        "200":
          description: Action accepted and broadcast
        "400":
          description: Invalid action
        "401":
          description: Not authenticated
components: {}
tags:
  - name: Auth
  - name: Video
  - name: Sync

---

# Realtime Channel (WebSocket)
# - Connect after /login
# - Emit: {type: "play"|"pause"|"seek", position_ms?: number}
# - Receive: {type, position_ms, actor, timestamp}
